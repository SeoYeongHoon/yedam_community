<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{common/layouts/admin_layout}"
	layout:fragment="Admin">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<style>
#modalWrap {
	position: fixed; /* 화면에 고정 */
	z-index: 1; /* 상위에 위치 */
	padding-top: 200px;
	left: 0;
	top: 0;
	width: 100%;
	height: 100%;
	overflow: auto;
	background-color: rgba(0, 0, 0, 0.7); /* 반투명한 배경색 */
	display: none; /* 초기에는 숨김 */
}
#modalWrap2 {
	position: fixed; /* 화면에 고정 */
	z-index: 1; /* 상위에 위치 */
	padding-top: 200px;
	left: 0;
	top: 0;
	width: 100%;
	height: 100%;
	overflow: auto;
	background-color: rgba(0, 0, 0, 0.7); /* 반투명한 배경색 */
	display: none; /* 초기에는 숨김 */
}

#modalBody {
	width: 70%;
	height: 70%;
	padding: 30px 30px;
	margin: 0 auto;
	border: 1px solid #777;
	background-color: #fff;
}
#modalBody2 {
	width: 50%;
	height: 90%;
	padding: 30px 30px;
	margin: 0 auto;
	border: 1px solid #777;
	background-color: #fff;
}
.close-area {
            display: inline;
            float: right;
            padding-right: 10px;
            cursor: pointer;
            color: black;
        }
li {
	display : inline;
	
}        
</style>
<p th:text="${quizList}"></p>
<div>
	<button type="button" id="subBtn" class="main-btn primary-btn-light btn-hover">과목 추가/삭제</button>
	<ul>
		<li>
			<div class="select-style-1">
				<label>과목선택</label>
				<div class="select-position">
					<select>
					<th:block th:each="subjectInfo, idxStat : ${subjectList}">
						<option value="">[[${subjectInfo.subjectName}]]</option>
					</th:block>	
					</select>
				</div>
			</div>
		</li>
        <li>
            <a href="#0" class="main-btn danger-btn-light btn-hover">시험출제</a>
        </li>
		<li>
            <a href="quizinsert" class="main-btn primary-btn-light btn-hover">새문제</a>
        </li>
        <li> 
            <a href="#0" class="main-btn primary-btn-light btn-hover">문제선택</a>
        </li>
	</ul>
</div>	

<div id="quizBox">
<th:block th:each="quizInfo, idxStat : ${quizList}">
<div class="col-xl-4 col-lg-4 col-md-6 col-sm-6">
	<div class="card-style-3 mb-30">
		<div class="card-content" >
			<h4>
				<a href="#0">Card Title here </a>
			</h4>
			<!-- <p>[[${quizList}]]</p>> -->
			<p>[[${idxStat.index}]]</p>
			<p>[[${quizInfo.quizId}]]. [[${quizInfo.quizContent}]] </p>
			<br>
			<th:block th:each="answerInfo, idxStat : ${answerList}">
			<p>[[${answerInfo.textContent}]]</p>
			</th:block>
			<a class="infoBtn">자세히 보기</a><br>
			<button id="updateBtn">아작스테스트</button>
		</div>
	</div>
</div>
</th:block>
<!-- end col -->
</div>	

<!-- 문제 상세보기 모달창 -->
<div id="modalWrap" class="modal-overlay">
	<div id="modalBody">
			<div class="close-area">X</div>
				<h3>문제</h3>
				<th:block th:each="quizInfo, idxStat : ${quizList}">
					<p>[[${quizInfo.quizId}]]. [[${quizInfo.quizContent}]]</p>
				</th:block>
			<br>
			<br>
			<div>
				<h3>정답 지문</h3>
				<th:block th:each="answerInfo, idxStat : ${answerList}">
					<p>[[${answerInfo.textContent}]]</p>
				</th:block>	
			</div>
			<br>
			<br>
			<div>
				<h3>문제 해설란</h3>
				<br>
				<th:block th:each="quizInfo, idxStat : ${quizList}">
					<p>[[${quizInfo.quizSolution}]]</p>
				</th:block>
			</div>
			<div style="text-align: center;">
				<button id="closeBtn" class="main-btn primary-btn btn-hover"
					type="button" onclick="location.href='quizlist'" >확인</button>
			</div>
			
	</div>
</div> 
<!-- 문제 상세보기 모달창 end--> 

<!-- 과목추가 모달창 -->
<div id="modalWrap2" class="modal-overlay">
	<div id="modalBody2">
		<div class="close-area">X</div>
		<div class="input-style-1">
			<!-- ======= checkbox style start ======= -->
                <div class="card-style mb-30">
                  <h6 class="mb-25">과목 설정</h6>
                  <th:block th:each="subjectInfo, idxStat : ${subjectList}">
                  <div class="form-check checkbox-style mb-20">
                    <input class="form-check-input" type="checkbox" value="" id="checkbox-1" />
                    <label class="form-check-label" for="checkbox-1">
                      [[${subjectInfo.subjectName}]]</label>
                  </div>
               	  </th:block>
				  <button type="button" class="main-btn danger-btn btn-hover" 
				  >삭제</button>
                </div>
                <!-- ======= checkbox style end ======= -->
		</div>
	
		
		<form th:action="@{/subjectinsert}" method="post" th:object="${teacherVO}">
		<div>
			<div class="input-style-1">
            	<input type="text" placeholder="과목명을 입력하세요"></input>
            </div>
			<button class="main-btn primary-btn btn-hover"
				type="submit">과목추가</button>
		</div>
		</form>	
	</div>
</div> 	
<!-- 과목추가 모달창 end -->
<script>

$(function() {
			$("button").on("click", function() {
				$("#test").append('template');
			});
		});


$('#updateBtn').on('click', updateAjaxJq);

function updateAjaxJq(event){
	//let dataObj = getEmpObj();
	// Ajax
	$.ajax({
		url: "quizlist",
		type: "GET", 
				
		success : function(data){
			console.log(data);
			$(data).each(function(){
				console.log('성공')
				});
			},
		error :function(){
			console.log('실패');
			}
		
	}); 
	
	// fetch 사용
	/* fetch('quizlist')
	.then(resolve => resolve.json())
	.then(result => {
		
		console.log(result);
		
	})
	.catch(err => console.log(err)); */
	
	// $.get사용
	/* $.get('quizList', function(result) {
			console.log(result);
		}) */
	
	
	
};

//모달창
const modal = document.querySelector(".modal-overlay"); // 문제 상세보기 모달창 형태 불러오기
const modalSub = document.getElementById("modalWrap2"); // 과목추가 모달창 형태 불러오기
//const modal = document.getElementById("modalWrap"); // 모달 창 요소 가져오기

$('#quizBox').on('click', '.infoBtn', function (e) {
	modal.style.display = "flex"; // 버튼 클릭시 모달 보임
});

$('#subBtn').on('click', function(e){
	modalSub.style.display = "flex";
})

// X버튼 누르면 모달창 닫기
$('.modal-overlay').on('click', '.close-area',function (e){
	modal.style.display = "none";
	modalSub.style.display = "none";
})

// 모달창 밖에 화면 누르면 모달창 닫는 기능
modal.addEventListener("click", e => {
    const evTarget = e.target
    if(evTarget.classList.contains("modal-overlay")) {
        modal.style.display = "none"
    }
})

modalSub.addEventListener("click", e => {
    const evTarget = e.target
    if(evTarget.classList.contains("modal-overlay")) {
        modalSub.style.display = "none";
    }
})

// esc누르면 모달창 닫기
window.addEventListener("keyup", e => {
    if(modal.style.display === "flex" && e.key === "Escape") {
        modal.style.display = "none"
    } else if(modalSub.style.display === "flex" && e.key === "Escape") {
    	modalSub.style.display = "none"
    }
    
})



</script>
</html>