<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{common/layouts/admin_layout}"
	  layout:fragment="Admin">
	  
	<script>
		function addCurriculum() {
	        var formData = $("#add_course_form").serialize();
	        
	        if (confirm("입력하신 과정을 등록하시겠습니까?")) {
		        $.ajax({
		            url: '/manageCourse',
		            type: 'POST',
		            data: formData,
		            success: function(response) {
		                alert("과정이 성공적으로 등록되었습니다!");
		                location.reload();
		            },
		            error: function(xhr, status, error) {
		                alert("과정 등록에 실패했습니다. 다시 시도해주세요.");
		                console.error(error);
		            }
		        });
	        }
	        
	    }
	</script>
	
	<div id="manage-container">
		<div class="course_wrapper">
			<div class="content-top">
				<h2 class="mb-10" style="color: white">수강과정 관리</h2>
				<a class="open_add_course main-btn light-btn btn-hover" style="color: white; background-color: #e96b56; padding: 7px 20px; position: absolute; margin: 0; right: 14px; bottom: 14px;">수강 등록</a>
				
				<!-- 수강등록 버튼 클릭 시 display: flex -->
				<form id="add_course_form" method="post">
					<div class="add_course">
						<div class="input-style-1 add_course_item">
							<label class="course_item_type" style="color: white;">과정명</label>
			                <input name="curriculumName" style="background: white;" type="text" placeholder="과정명을 입력하세요.">
			            </div>
			            <div class="input-style-1 add_course_item">
							<label class="course_item_type" style="color: white;">과정 시작</label>
			                <input name="curriculumStartDate" style="background: white;" type="date">
		            	</div>
		                <p style="margin-right: 20px; color: white; font-size: 15pt"> - </p>
		            	<div class="input-style-1 add_course_item">
		            		<label class="course_item_type" style="color: white;">과정 종료</label>
		                	<input name="curriculumEndDate" style="background: white;" type="date">
		            	</div>
		            	<div class="input-style-1 add_course_item">
							<label class="course_item_type" style="color: white;">강의실</label>
			                <input name="classId" style="background: white;" type="number" placeholder="강의실을 입력하세요.">
			            </div>
			            <div class="input-style-1 add_course_item">
			            	<label class="course_item_type" style="color: white;">이미지</label>
			            	<input name="curriculumImg" type="file">
			            </div>
			            <!-- <div class="filebox">
				            <label for="ex_file">이미지 업로드</label> 
				            <input type="file" name="curriculumImg" id="ex_file"> 
			            </div> -->
		            	<a onclick="addCurriculum()" class="main-btn light-btn btn-hover" style="color: white; background-color: #e96b56; padding: 5px 25px;">등록</a>
					</div>
				</form>
			</div>
			
			
			
			<!-- <a href="#0" class="main-btn dark-btn btn-hover" style="padding: 5px 25px; position: absolute; margin: 0; right: 200px;">등록</a> -->
			<div class="course_item">
				<table class="table">
					<thead>			
					</thead>
					<tbody id="courseInfoTable" style="display: flex; flex-wrap: wrap">
						<tr class="curriculum_item" th:each="curriculum : ${class}" style="max-width: 300px; min-height: 400px; border: 2px solid #5d657b; margin: 20px; border-radius: 5px; position: relative;">
							<td style="border: none;">
								<a href="#" class="">
									<p style="border-bottom: 2px solid #5d657b; padding: 20px; margin-top: -20px; color: black; font-weight: bold;">
										[[${#dates.format(curriculum.curriculumStartDate, 'yyyy년 MM월 dd일')}]] - [[${#dates.format(curriculum.curriculumEndDate, 'yyyy년 MM월 dd일')}]]
									</p>
									<p style="border-bottom: 2px solid #5d657b; padding: 20px; font-size: 13pt; color: black; font-weight: bold;">[[${curriculum.curriculumName}]]</p>
									<img th:src="@{/images/{fileName}(fileName=${curriculum.curriculumImg})}" style="max-width: 100%;">
									<!-- <div>
										<img src="https://daeguoracle.com/resources/img/temp4.jpg" style="max-width: 100%;">
									</div> -->
									
								</a>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
	
	<div id="result" style="color: white;"></div>
	
	<script>
		const addCourse = document.querySelector('.add_course');
		const addBtn = document.querySelector('.open_add_course');
		
		addBtn.addEventListener('click', function() {
			if (addBtn.innerText == '닫기') {
				addCourse.style.display = 'none';
				addBtn.innerText = '수강 등록';
			} else if (addBtn.innerText == '수강 등록') {
				addCourse.style.display = 'flex';
				addBtn.innerText = '닫기';
			}
			
		})
	</script>
</html>