<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layouts/default_layout}"
      layout:fragment="Home">
      
<head>
  <title>게시글 목록</title>
</head>

<body>
<div id="post_container">
<div class="col-lg-12" id="allClass" style="margin-top: 20px;">
	<!-- 게시판 선택 버튼 -->
	<div class="card-style mb-30" >
		<ul class="buttons-group">
			<li th:each="curriculums : ${curriculum}">
				<button type="button" style="padding: 10px 30px;"
					class="main-btn success-btn-outline btn-hover classNum active curriculum"
					th:value="${curriculums.curriculumId}">[[${curriculums.curriculumName}]]</button>
			</li>
		</ul>
	</div>
	<!-- end card -->
</div>
<div id="search"></div>
<div id="postList">
	<table class="table">
	    <thead>
	      <tr>
	        <th class="postTableHeader">게시글 번호</th>
	        <th class="postTableHeader">제목</th>
	        <th class="postTableHeader">작성자</th>
	        <th class="postTableHeader">작성시간</th>
	        <th class="postTableHeader">조회수</th>
	        <th class="postTableHeader">추천수</th>
	      </tr>
	    </thead>
	    <tbody id="tbody">
	    </tbody>
	  </table>
</div>

<p>footer</p>
<p>footer</p>
<p>footer</p>
<p>footer</p>
<p>footer</p>
<p>footer</p>
<p>footer</p>
<p>footer</p>
<p>footer</p>
<p>footer</p>
<p>footer</p>
</div>
<script>
//--------------------------
// 페이지 로드
//--------------------------
 $().ready(function(){
	 searchForm();
	 postList();
})

//검색창
function searchForm(){
	let search =
		`
			<div>
				<form id="searchForm" method="get" >
	    			<input style="border: solid black 1px; top: 80px;" type="text" name="keyword" id="searchKeyword" placeholder="검색어를 입력하세요" />
  				</form>
 			</div>
		`
	$('#search').append(search)
} // postList end 

//게시글 리스트
function postList(){
	
	$.ajax({
		url:'/all/postList',
		type:'get',
		async: false,
		success: function(data){
			data.forEach(function(e){
				console.log(e.postId)
				let postData = formatDate(e.createDate);
				console.log("게시글 날짜"+postData)
				let post =
					`
			      		<tr id="tr" onclick="location.href='/all/post/1/${e.postId}'">
			        		<td class="postTableData">${e.postId}</td>
					       	<td class="postTableData">${e.title}</td>
			        		<td class="postTableData">${e.writer}</td>
			        		<td class="postTableData">${postData}</td>
			        		<td class="postTableData">${e.postView}</td>
			        		<td class="postTableData">${e.postLike}</td>
			      		</tr>
			  		`
			  	$('#tbody').append(post)
			})
		},
		error: function(){
			alert('게시글리스트 아작스 실패')
		}
	})
	
} //postList end
$('.curriculum').on('click',function(){
	let curriculumId = $(this).val()
	
	$.ajax({
		url:'/all/selectPost',
		type:'',
		data:{},
		success:function(data){
			alert("커리큘럼 버튼 성공")
		},
		error:function(err){
			alert('커리큘럼 버튼 실패')
		}
	})
})
//----------------------
//날짜 포멧 변환 함수
//----------------------
function formatDate(date) {
	var d = new Date(date), month = '' + (d.getMonth() + 1), day = ''
			+ d.getDate(), year = d.getFullYear();

	if (month.length < 2)
		month = '0' + month;
	if (day.length < 2)
		day = '0' + day;

	return [ year, month, day ].join('-');
} 

</script>
</body>
</html>